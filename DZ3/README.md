# Домашняя работа 3 - Кластеризация и Обучение с подкреплением

Домашняя работа состоит из двух частей:

## Часть 1: Кластеризация

Обучил и сравнил 5 методов кластеризации на датасете Brazilian E-Commerce:

- **K-Means** - простой метод для сферических кластеров
- **DBSCAN** - находит кластеры произвольной формы
- **Agglomerative Clustering** - иерархическая кластеризация
- **Gaussian Mixture Model (GMM)** - для перекрывающихся кластеров
- **Spectral Clustering** - для невыпуклых кластеров

### Задача кластеризации:
Кластеризация клиентов по их покупательскому поведению:
- Общая сумма покупок
- Количество заказов
- Средний чек
- Среднее время между заказами
- Количество различных категорий товаров

### Метрики сравнения:
- Silhouette Score (чем выше, тем лучше)
- Davies-Bouldin Index (чем меньше, тем лучше)
- Calinski-Harabasz Index (чем выше, тем лучше)

## Часть 2: Обучение с подкреплением

Обучил агента для задачи CartPole с помощью методов RL:

- **Q-Learning** - табличный метод с дискретизацией состояний
- **Deep Q-Network (DQN)** - нейросетевая версия Q-Learning
- **REINFORCE** - метод градиента политики

### Метрики оценки:
- Средняя награда за эпизод
- Длина эпизода (количество шагов)
- Скорость сходимости

## Что сделано

### Кластеризация:
- Загрузка данных Brazilian E-Commerce
- Создание признаков для кластеризации клиентов
- Определение оптимального количества кластеров (метод локтя)
- Нормализация данных
- Обучение 5 методов кластеризации
- Визуализация результатов (PCA для 2D)
- Сравнение по метрикам качества

### Обучение с подкреплением:
- Создание окружения CartPole
- Реализация Q-Learning агента
- Реализация DQN агента (с PyTorch)
- Реализация REINFORCE агента (с PyTorch)
- Визуализация процесса обучения
- Сравнение результатов

## Запуск

```bash
jupyter notebook dz3.ipynb
```

## Требования

Установите зависимости:

```bash
pip install -r requirements.txt
```

**Примечание**: PyTorch опционален. Если он не установлен, DQN и REINFORCE будут пропущены, но Q-Learning будет работать.

## Структура

- `dz3.ipynb` - основной ноутбук с кодом
- `requirements.txt` - зависимости проекта
- `README.md` - описание работы

## Данные

Используется датасет Brazilian E-Commerce от Olist (тот же, что в DZ2 и DZ4).
Данные должны быть в папке `../DZ2_24_11/data/` или скопированы в `data/`.
