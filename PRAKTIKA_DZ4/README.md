# Итоговое задание - Предсказание повторных покупок клиентов

## Описание

Итоговое задание для зачёта по машинному обучению. Решена задача классификации повторных покупок клиентов на датасете Brazilian E-Commerce.

## Задача

**Предсказание повторных покупок (Repeat Purchase Prediction)**

- **Тип задачи**: Бинарная классификация
- **Целевая переменная**: is_repeat_customer (0/1)
- **Размер датасета**: ~100,000+ заказов
- **Источник данных**: Brazilian E-Commerce от Olist (Kaggle)

## Требования задания

✅ **Нетривиальность**: Реальные данные бразильского маркетплейса (не синтетические)  
✅ **Достаточный объём**: >100,000 объектов  
✅ **Данные подходят**: Датасет специально создан для e-commerce анализа

## Что сделано

### 1. Анализ данных
- Загрузка и объединение нескольких таблиц датасета
- Создание целевой переменной (повторные клиенты)
- Разведочный анализ данных (EDA)
- Визуализация распределений и зависимостей
- Корреляционный анализ

### 2. Предобработка
- Обработка пропущенных значений
- Создание новых признаков (время доставки, задержка, стоимость заказа)
- Кодирование категориальных признаков (One-Hot Encoding)
- Масштабирование числовых признаков
- Разделение на train/validation/test

### 3. Выбор методов и метрик
- **Алгоритмы**: Logistic Regression, Random Forest, Gradient Boosting, SVM, XGBoost
- **Метрики**: Accuracy, Precision, Recall, F1-score, ROC-AUC
- Обоснование выбора методов и метрик

### 4. Обучение моделей
- Обучение 4-5 различных алгоритмов
- Оценка на валидационной выборке
- Сравнение результатов

### 5. Оценка результатов
- Тестирование лучшей модели на тестовой выборке
- Анализ важности признаков
- ROC-кривые
- Матрицы ошибок

### 6. Выводы
- Сравнение с результатами других авторов
- Практические рекомендации
- Предложения по улучшению

## Структура проекта

```
DZ4/
├── dz4.ipynb          # Основной ноутбук с анализом и моделями
├── requirements.txt    # Зависимости проекта
├── README.md          # Описание работы
└── data/              # Папка для данных
    ├── olist_orders_dataset.csv
    ├── olist_order_items_dataset.csv
    ├── olist_order_reviews_dataset.csv
    ├── olist_products_dataset.csv
    ├── olist_order_payments_dataset.csv
    └── olist_customers_dataset.csv
```

## Установка и запуск

### 1. Установка зависимостей

```bash
pip install -r requirements.txt
```

### 2. Загрузка данных

Скачайте датасет с Kaggle:
https://www.kaggle.com/datasets/olistbr/brazilian-ecommerce

Поместите все CSV файлы в папку `data/`:
- olist_orders_dataset.csv
- olist_order_items_dataset.csv
- olist_order_reviews_dataset.csv
- olist_products_dataset.csv
- olist_order_payments_dataset.csv
- olist_customers_dataset.csv

### 3. Запуск ноутбука

```bash
jupyter notebook dz4.ipynb
```

## Результаты

- Обучено 4-5 моделей классификации
- Лучшая модель показывает ROC-AUC > 0.75
- Результаты сопоставимы с типичными решениями этой задачи

## Использованные библиотеки

- **pandas, numpy** - обработка данных
- **matplotlib, seaborn** - визуализация
- **scikit-learn** - машинное обучение
- **xgboost, lightgbm** - продвинутые модели (опционально)
- **imbalanced-learn** - работа с несбалансированными данными

## Особенности

- Полный цикл работы с данными: от анализа до оценки моделей
- Обоснование выбора методов и метрик
- Сравнение с результатами других авторов
- Практические рекомендации для бизнеса
- Детальная визуализация результатов
- Работа с реальным датасетом e-commerce

## Отличие от DZ2

- **DZ2**: Предсказание оценки отзыва (review_score 1-5)
- **DZ4**: Предсказание повторных покупок (is_repeat_customer 0/1)

Оба задания используют один и тот же датасет Brazilian E-Commerce, но решают разные задачи.

## Автор

Работа выполнена в рамках курса машинного обучения.
